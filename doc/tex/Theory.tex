\label{sec:theory}
The \fitter\ program uses currently as standard the DGLAP~\cite{Gribov:1972ri,Gribov:1972rt,Lipatov:1974qm,Dokshitzer:1977sg,Altarelli:1977zs}
 evolution equations as implemented in the QCDNUM~\cite{qcdnum} program. The fit 
procedure begins with parameterising the input PDFs at the starting 
scale $Q^2_0$ which should be chosen to be below the charm mass threshold
$m_C^2$.
The PDFs are then evolved using the DGLAP evolution equations  
at NLO~\cite{Curci:1980uw,Furmanski:1980cm} in the $\overline{\text{MS}}$ scheme.
%The renormalisation and factorisation scales are set to $Q^2$. 
The LO and NNLO evolutions are also provided by the QCDNUM and can be 
selecteed via the steering parameters in \fitter\ . 

The cross-section predictions are obtain by convoluting the PDFs with the 
hard scattering coefficient functions. For the DIS processes, those are calculated 
using the Fixed-Flavour number (FFN)~\cite{Laenen:1992,Laenen:1993,Riem:1995} or 
the general mass Variable-Flavour number (VFN) schemes. 
The program implements the zero mass variable flavour number (ZMVFN) scheme from QCDNUM.

%The various treatments for the heavy quark thresholds are implemented as provided by the MSTW group
The VFN schemes with various treatments for the heavy quark thresholds are implemented in \fitter\ 
as provided by the MSTW group
- the RT scheme with its variants at NLO and NNLO ~\cite{Thorne:1997ga,Thorne:2006qt}, 
as provided by the CTEQ group - the ACOT scheme with its variants at LO and NLO, 
as provided by the ABM group - the BMSN scheme at NLO and NNLO~\footnote{The BMSN scheme as provided by ABM group 
currently is not yet fully implemented in \fitter\ .}. The fixed-flavour number scheme
is available via the QCDNUM implementation and via the {\tt OPENQCDRAD~\cite{openqcdrad:page} } interface.
Each of these schemes is briefly discussed in further details.

The jet cross sections
are calculated using APPLGRID or FastNLO. The program has two implementations
for $pp$  Drell Yan processes: The first implementation uses
calculations at LO which can be extended to NLO using k-factors,
the second uses the APPLGRID interface.
For thorough details of the theoretical modules we direct the user to read the provided references of these packages.


%%%%%%%%%%%
\subsection{DIS and Schemes}
%There are different approaches to the treatment of the heavy quark production. 
%These include the fixed-flavour (FFN) and variable flavour number (VFN) schemes.
%%%%
\subsubsection{ZMVFNS}
The evolution program QCDNUM~\cite{qcdnum} used in \fitter\ provides 
the calculation of the deep inelastic structure functions in the zero-mass, 
generalised mass and the fixed flavour number schemes. 
In the zero-mass variable flavour number scheme (ZM-VFNS) heavy quark densities are
included into proton above quark masses but they are treated as massless in both,
the initial and final states.
This scheme is accurate in the region where $Q^2$ is so much greater than $m_h^2$
but becomes unreliable for $Q^2 \sim m_h^2$. \\
The un-polarised DIS structure functions in ZM-VFN scheme are computed as a 
convolution of the parton densities with zero-mass coefficient functions and 
in \fitter\ are activated via namelist {\tt HF$\_$SCHEME} in the {\tt steering.txt}.
%%%%
\subsubsection{TR}

The Thorne-Roberts (TR) scheme is a general-mass variable flavour number scheme (GM-VFNS) used as default for the MTSW PDF sets. GM-VFNS smoothly connect the two regions: scale below the heavy quark threshold and the scale above the heavy quark threshold. However, the definition is not unique.
A GM-VFNS can be defined by demanding equivalence of the nf = n (FFNS) and nf = n+1 flavour (ZM-VFNS) descriptions above the transition point for the new parton distributions
(they are by definition identical below this point), at all orders. However, the equivalency of swapping the $O(m_{H}^2/Q^2)$ 
terms without violating the definition of a GM-VFNS is what mainly distinguish the ACOT from TR schemes. 
One major issue in a complete GM-VFNS, is that of the ordering of the
perturbative expansion. This ambiguity comes about because the ordering in alphas is different for the number of active flavours.


 
%%%%
\subsubsection{ACOT}

The Aivazis-Collins-Olness-Tung scheme  belongs to the group of VFN factorization schemes that uses the renormalization method of Collins-Wilczek-Zee (CWZ).This scheme involves a mixture of the $\overline{\text{MS}}$ scheme for light partons (and for heavy partons if the factorisation scale is larger than the heavy mass)and the zero-momentum subtraction renormalization scheme for graphs with heavy quark lines (if factorisation scale is smaller than the mass of the heavy quark threshold).

There are different variants of this scheme which are all incorporated in the \fitter\  framework and can be selected 
via namelist {\tt HF$\_$SCHEME} in the {\tt steering.txt} .

%%%%
\subsubsection{FFNS}

The fixed-flavour number scheme for DIS structure functions in \fitter\ can be selected via {\tt HF$\_$SCHEME}
using QCDNUM or ABM~\cite{openqcdrad:page} implementation.
In the FFN scheme only gluon and the light quarks are considered
as partons within the proton, massive quarks are produced perturbatively in the final state.
\\
In addition, the recent variant of the fixed-flavour number scheme in which the running mass definition 
is used in the $\overline{\text{MS}}$ scheme~\cite{Alekhin:runm} can be selected
in \fitter\ . This variant is realised via the interface to the open-source code 
OPENQCDRAD~\cite{openqcdrad:page}.
This scheme has the advantage of reducing the sensitivity of the DIS cross sections to
higher order corrections, and improving the theoretical precision of the mass definition. 
\\           
In the QCDNUM, the calculation of the heavy quark contributions to DIS structure functions
are avalable at NLO and only electromagnetic exchange contributions are taken into account.
In the ABM implementation, the QCD corrections to the massive Wilson coefficients 
up to the NNLO for the neutral-current (NC) heavy-quark production~\cite{} and up to NLO
for the charged-current (CC) case are available.
%
%The fixed-flavour number scheme for  in \fitter\ can be also accessed via interface to
%the open-source code OPENQCDRAD~\cite{openqcdrad:page} in \fitter\ framework 
%provides an access to 
%fixed flavour number scheme (FFNS)~\cite{Laenen:1992,Laenen:1993,Riem:1995}
%
%By default, in FFNS the number of light quark 
%flavours $n_{f}$ (here $n_{f}=3$) are considered in the PDF evolution and heavy (massive) 
%quarks appear only in the final state. 
%The QCD corrections to the massive Wilson coefficients which are known up to the NNLO
%for the neutral-current (NC) heavy-quark production~\cite{} are implemented in OPENQCDRAD.
%In the case of charged-current (CC), the massive NLO QCD corrections~\cite{} are available.
%In addition, the treatment of the heavy-quark contributions in DIS are provided 
%in both, the pole-mass and the running-mass definition in $\overline{\text{MS}}$ 
%scheme~\cite{Alekhin:runm}. \\
%In case the FFN scheme is chosen as the fitting option (see corresponding instructions in the section 1),
%the heavy quark contributions to DIS structure functions $F_2$ and $F_L$ (and $F_3$ in the charged 
%current case) are calculated in the FFNS and together with the light-flavor contributions are 
%provided for the theory prediction calculation (theory$\_$dispatcher.f).
%The interpolation to PDFs and $\alpha_s$ evolution from QCDNUM are set up in the interface to OPENQCDRAD. \\
%The variation of the renormalisation and factorisation scales for heavy quarks is 
%possible (see available options in steering.txt file).
%
%       
%%%%%%%%%%%
\subsubsection{\texorpdfstring{$ep$}{ep} Electroweak corrections}
%%%%%%%%%%%
 
To properly compare the experimental data with theoretical predictions, 
QED corrections are necessary. In the HERAFitter, the electroweak corrections 
for the DIS process are based on the EPRC package provided by Hubert Spiesberger \cite{HS}.
The measured cross sections as presented by HERA are not corrected for the weak corrections
in order to retain sensitivity to higher order EW effects.

The calculations of higher-order electroweak corrections to DIS scattering at HERA are performed
in the on-shell scheme where the gauge bosons masses $M_W$ abd $M_Z$ are treated symmetrically
as basic parameters together with the top and Higgs masses, besides the fine structure constant $\alpha$ and other fermion masses.

The code provides the running of $\alpha$ using the most recent parametrisation
of the hadronic contribution to $\Delta_\alpha$ \cite{Jegerlehner}, as well as an older 
one from Burkhard.

For the Drell Yan process there are independent treatments (such as SANC, FEWZ).

 


\subsection{Drell Yan process}
%%%%

The calculatiosn of the Drell Yan processes are known for many observables up to  the NNLO order. For example, there are packages such as FEWZ, DYNNLO for NNLO, or MCFM for NLO calculations. However, due to the complicated nature of these calculation involving an increased number of diagrams with additional higher order, these calculations are too slow to be used iteratively in a fit.
There are various methods to overcome this shortage: using the "k-factors" approximation from lower to higher order,  or using the grid technique when available.
  

The leading order Drell-Yan~\cite{Drell:1970wh,Yamada:1981mw} cross section 
for the neutral current, triple differential in
invariant mass \(M\), boson rapidity \(y\) and CMS
lepton scattering angle \(\cos\theta\), can be written as
\begin{align}
\frac{\mathrm{d}^3\sigma}{\mathrm{d}M\mathrm{d}y\mathrm{d}\cos\theta} &=
  \frac{\pi\alpha^2}{3MS}\sum_{q}P_q
  \left[F_q(x_1,Q^2)F_{\bar{q}}(x_2,Q^2) + (q\leftrightarrow\bar{q})\right],
\end{align}
where \(S\) is a squared CMS beam energy, \(x_{1,2} = \frac{M}{\sqrt{S}}\exp(\pm y)\) and 
\begin{align}
  P_q &=  e_l^2e_q^2(1+\cos^2\theta) \nonumber \\
      &+  e_le_q\frac{2M^2(M^2-M_Z^2)}{\sin^2\theta_W\cos^2\theta_W
          \big[(M^2-M_Z^2)^2+\Gamma_Z^2M_Z^2\big]}
          \big[aA_q(1+\cos^2\theta)+2bB_q\cos\theta\big] \nonumber \\
      &+  \frac{M^4}{\sin^4\theta_W\cos^4\theta_W
          \big[(M^2-M_Z^2)^2+\Gamma_Z^2M_Z^2\big]}
          \big[(a^2+b^2)(A_q^2+B_q^2)(1+\cos^2\theta)+8abA_qB_q\cos\theta\big].
\end{align}
Here \(\theta_W\) is the Weinberg angle, \(M_Z\) and \(\Gamma_Z\) are Z boson mass and 
width, and
\begin{align}
 a & = -\frac{1}{4} + \sin^2\theta_W,  \nonumber \\
 b & = -\frac{1}{4},  \nonumber \\
 A_q & = \frac{1}{2}I_q^3-e_q\sin^2\theta_W, \nonumber \\
 B_q & = \frac{1}{2}I_q^3,  \nonumber \\
 I_u^3 & = -I_d^3 = \frac{1}{2},  \nonumber \\
 e_l & = -1, e_u = \frac{2}{3}, e_d = -\frac{1}{3}.
\end{align}

The expression for charged current has simpler form:
\begin{align}
\frac{\mathrm{d}^3\sigma}{\mathrm{d}M\mathrm{d}y\mathrm{d}\cos\theta} &=
 \frac{\pi\alpha^2}{48S\sin^4\theta_W}
 \frac{M^3(1-\cos\theta)^2}{(M^2-M_W^2)+\Gamma_W^2M_W^2}
 \sum_{q_1,q_2}V_{q_1q_2}^2F_{q_1}(x_1,Q^2)F_{q_2}(x_2,Q^2),
\end{align}
where \(V_{q_1q_2}\) is the CKM quark mixing matrix and \(M_W\) and \(\Gamma_W\)
are \(W\) boson mass and decay width.

The simple form of these expressions allows to calculate integrated
cross sections without utilization of Monte-Carlo techniques.
This is particularly useful for PDF fitting purposes because
the statistical fluctuations are avoided in this case. In both 
neutral and charge current expressions the parton density functions
factorize as a function dependent only on boson rapidity \(y\) and
invariant mass \(M\) leaving \(\cos\theta\) dependence aside.
The integral in \(\cos\theta\) can be computed analytically and
integrations in \(y\) and \(M\) can be performed with Simpson
method. The \(\cos\theta\) parts are kept in the equation 
explicitly because their integration is asymmetric for
data in lepton \(\eta\) bins and also is being performed when applying 
the lepton \(p_{\perp}\) cuts.

The fact that PDF functions factorize with the rest part of 
expression allows to significantly boost calculations when 
performing parameter fits over lepton rapidity data. In this case
the factorized part of expression independent on PDFs can be
calculated only once for all minimization iterations.
The leading order code in HERAFitter package implements this 
optimization and uses fast convolution routines provided by
QCDNUM. Currently the full width LO calculations are optimized 
for lepton pseudorapidity and boson rapidity distributions with
possibility to apply lepton \(p_{\perp}\) cuts.

The calculated leading order cross sections are multiplied by
NLO or NNLO K-factors provided for corresponding data distributions.
%%%%


On the other hand, one can obtain directly the NLO predictions by using APPLGRID or FASTNLO techniques, which rely on factorisation theorem by decoupling the hard scattering coefficients from PDFs. Therefore, the calculated hard scattering coefficients can be stored into a grid for a given kinematic bin, speeding up the convolution process with the PDFs allowing to be used for QCD fits. 
These method are described in more details in sections \ref{sec:theory:jets}

%%%%%%%%%%%
\subsection{\texorpdfstring{$t\bar{t}$}{t-tbar} Cross Sections via {\tt HATHOR}}
Top-quark pairs ($t\bar{t}$) are mainly produced via $gg$ fusion and
$q \bar q$ annihilation. Furthermore, there are the $q q'$ and
$q g$ production modes.
The program HATHOR~\cite{Aliev:2010zk} allows calculating
the expected total $t \bar t$ cross section at hadron colliders
($p \bar p$ and $p p$) up to approximate NNLO accuracy.
Version 1.3 of HATHOR includes the exact NNLO for $q \bar q \to t \bar t$ \cite{Baernreuther:2012ws}
as well as a new high-energy constraint on the approximate NNLO obtained from
soft-gluon resummation \cite{Moch:2012mk}.
The default choice for renormalization and factorization scale in $t \bar t$ production is the top-quark mass, $m_t$.
The pole mass scheme is typically employed for $m_t$ but HATHOR also supports calculations in
the $\overline{\text{MS}}$ scheme.
\subsection{Jets}\label{sec:theory:jets}
The calculation of higher order jet cross sections is very demanding
in means of computing power. The reasons are the large number of contributing
Feynman diagrams and also the large number of infrared divergencies.
For an accurate cancellation of these singularities, typically, the 
dipole subtraction method is applied in such calculations.
During the necessary Monte Carlo integration a very fine phase
space sampling has to be performed in order to account for the
accurate cancellation of the counter terms.

In order to enable the inclusion of jet-cross section 
measurements in PDF and $\alpha_s$ fits, these perturbative
coefficients have to be pre-computed in a PDF and $\alpha_s$ 
independent way. For this purpose, two quite similar tools are
interfaced to the HERAFitter.

\subsubsection{FastNLO}
The fastNLO project~\cite{Kluge:2006xs,Wobisch:2011ij,Britzger:2012bs}
enables the inclusion of jet data in PDF and $\alpha_s$ fits.
This tool uses multi-dimensional interpolation
techniques to convert the convolutions of perturbative 
coeffcients with parton distribution functions and 
the strong coupling into simple products.
Although the concept is process independent, the perturbative 
coefficients are usually calculated by the \texttt{NLOJET++}
program~\cite{Nagy:1998bb} where calculations for jet-production
in DIS~\cite{Nagy:2001xb}  as well as in hadron-hadron 
collisions~\cite{Nagy:2003tz,Nagy:2001fj} are available.
Also threshold-corrections of $\mathcal{O}$(NNLO) for 
inclusive jet cross sections in hadron-hadron collisions are
available~\cite{Kidonakis:2000gi}.

The fastNLO libraries are standardized included in the HERAFitter
package and no further requirements or compilation options
are needed. In order to include a new measurement into the PDF-fit,
the fastNLO table have to be specified. These tables include all
necessary informations of the perturbative coefficients and the
calculated process for all bins of a certain dataset. 
Tables for almost all published jet measurements
are available through the project website {\tt http://fastnlo.hepforge.org},
or have otherwise to be calculated by using the full fastNLO package.

Features of the fastNLO concept are the very quick convolution of the
perturbative coefficients with the PDFs of
$\mathcal{O}(100 ms)$ and the very high accuracy
of the interpolation procedure. 
The fastNLO tables are conventionally calculated
for multiple factors of the factorization scale, 
and the renormalization scale factor can be choosen freely.
Some of the fastNLO tables already involve a scale-independent
concept~\cite{Britzger:2012bs}, which allows for 
the free choice of the renormalization and the factorization
scale as a function of two pre-defined observables.
The evaluation of the strong coupling constant, which enters
the cross section calculation, is taken consistently from the 
QCDNUM evolution code.


\subsubsection{APPLGRID}
The APPLGRID~\cite{Carli:2010rw} package allows to compute a fast estimate
of NLO cross section for particular processes for arbitrary set of 
proton parton density functions. The package implements
calculation of cross section of electroweak boson (\(Z,W\))
production as well as jet production in proton-(anti)proton
collisions and DIS processes. 

The approach is based on storing perturbative coefficients
of NLO QCD calculations of final-state observables measured
in hadron colliders in look-up tables. The PDFs and the 
strong couplings are included during the final calculations,
e.g. during the PDF fits procedure. The method allows 
variation of factorization and renormalization scales in
calculations.

The look-up tables (grids) can be generated with modified versions of
of MCFM~\cite{Campbell:1999ah,Campbell:2010ff} or 
NLOjet++~\cite{Nagy:2001fj} software distributed
with the full version of APPLGRID package. NLO calculations
for the current analysis are performed with the help of APPLGRID
generated grids based on MCFM calculations. 

Run parameters
and electroweak parameters are set in MCFM in a standard way
via the input file and user's part of the code. 
Binning and definitions of the observables for which the
differential cross sections are needed are set in the 
APPLGRID code. 
The grid parameters \(x_1, x_2\) and \(Q^2\) binning
and interpolation orders are also defined in the code.

APPLGRID performs construction of the look-up tables in two 
steps: {\it (i)} exploration of the phase space in order
to optimize the memory storage and {\it (ii)} actual grid
construction in the phase space corresponding to the 
requested observables.

Afterwards the NLO cross sections are restored from the grids
with providing PDFs, \(\alpha_S\), factorization and 
renormalization scales and with QCD NNLO k-factors applied
if stated.

%%%%%%%%%%%
\subsection{DIPOLE models}

%At low $x$ and low $Q^{2}$, virtual photon-proton scattering is described using the colour
%dipole model formalism~\cite{NNZ:91}. Within this formalism, the scattering process is calculated as a fluctuation of the
%photon into a quark-antiquark pair (dipole), with a lifetime $\propto\enskip 1/x$, which interacts with the proton.
%
%Several approaches have been developed to phenomenologically describe the dipole-proton interaction
%cross section, three of which are implemented in the HERAFitter. These are
%the original model version (GBW)~\cite{Golec-Biernat:1998js}, a model based on the colour glass condensate approach
%to the high parton density regime (IIM)~\cite{Iancu:2003ge}, and a modified GBW model by adding effects of the 
Dipole picture provides an attractive approach to the virtual photon-proton scattering in the low $x$ region because it allows to describe inclusive and diffractive processes together. In this approach the virtual photon fluctuates into a $q\bar q$ (or $q\bar q g$ ....)  dipole which interacts with the proton~\cite{NNZ:91}.  The dipoles can be viewed as quasi-stable quantum mechanical states, which have very long life time $\propto 1/m_p x\;$ and a size which is not changed by scattering. 

Several dipole models have been developed to describe various DIS reactions. They vary due to different assumption made about the behavior of the dipole cross sections.   In the HERAFitter  three representative models  are implemented.
\begin{itemize}
\item
the original (GBW)~\cite{Golec-Biernat:1998js} dipole saturation model,
\item
  the colour glass condensate approach
to the high parton density regime (IIM)~\cite{Iancu:2003ge},
\item
  a modified GBW model which takes into account the effects of  
DGLAP evolution (BGK)~\cite{Bartels:2002cj}.
\end{itemize}
%%%%
\subsubsection{GBW model}
In the GBW model the dipole-proton cross section $\sigma_{\text{dip}}$ is given by
\begin{equation}
\label{eGBW}
   \sigma_{\text{dip}}(x,r^{2}) = \sigma_{0} \left(1 - \exp \left[-\frac{r^{2}}{4R_{0}^{2}(x)} \right]\right),
\end{equation}
where $r$ corresponds to the transverse separation between the quark and the antiquark, and $R_{0}^{2}$ is 
%an $x$ dependent scale parameter, having the form $R_{0}^{2}(x)=\left(x/x_{0}\right)^{\lambda}$.
an $x$ dependent scale parameter which has a meaning of saturation radius,  $R_{0}^{2}(x)=\left(x/x_{0}\right)^{\lambda}$.
The free fitted parameters are the cross-section normalisation $\sigma_{0}$ as well as $x_{0}$ and $\lambda$.
%%%%
\subsubsection{IIM model}
The IIM model assumes an improved expression for dipole cross section which is based on the 
Balitsky-Kovchegov equation~\cite{Balitsky:1995ub}. The explicit formula for $\sigma_{\text{dip}}$ 
can be find in~\cite{Iancu:2003ge}. The free fitted parameters are the alternative scale parameter $\tilde{R}$, $x_{0}$ and $\lambda$.
%%%%
\subsubsection{BGK model}
%The BGK model modifies the equation (\ref{eGBW}) by incorporating the LO and NLO DGLAP evolution
%of the gluon distribution. This leads to the expression for the dipole cross section
The BGK model modifies the GBW model by taking into account the  DGLAP evolution
of the gluon density. The dipole cross section is given by
\begin{equation*}
\label{eBGK}
   \sigma_{\text{dip}}(x,r^{2}) = \sigma_{0} \left(1 - \exp \left[-\frac{\pi^{2} r^{2} \alpha_{s}(\mu^{2}) xg(x,\mu^{2})}{3 \sigma_{0}} \right]\right).
\end{equation*}
The factorization scale $\mu^{2}$ has the form $\mu^{2} = C_{bgk}/r^{2}+\mu^{2}_{0}$.
%This model uses the following gluon density at the starting scale $Q_{0}^{2}=1\mbox{ GeV}^{2}$
In this model the gluon density, which  is parametrized  at some starting scale $Q_{0}^{2}$ by
\begin{equation*}
\label{eqTH730}
   xg(x,Q^{2}_{0}) = A_{g} x^{-\lambda_{g}}(1-x)^{C_{g}}.
\end{equation*}
is evolved to larger $Q^2$'s using LO and NLO DGLAP evolution.
The free fitted parameters for this model are $\sigma_{0}$, $\mu^{2}_{0}$ and 3 parameters for gluon $A_{g}$, $\lambda_{g}$, $C_{g}$. The parameter $C_{bgk}$ is kept fixed: $C_{bgk} = 4.0$. 
%%%%
%\newpage
%\subsubsection{Mixed with DGLAP model}
\subsubsection{BGK model with valence quarks}
The dipole models are valid in the low-$x$ region only, where the valence quark contribution is small, of the order of 5\%. The new HERA $F_2$ data have a precision which better than 2 \%. Therefore in the HERAfitter the contribution of the valence quarks is taken from the pdf fits and added to the original 
 BGK model. The quality of the fits of the BGK dipole model with valence quarks and without valence quarks are the same.
The default  initial parameters for the fit without valence quark are : 
\begin{table}[h]
\begin{center}
\begin{tabular}{|c||c||c||c|c||c|c|c||c|c|} 
\hline 
$\sigma_0$ & $A_g$ & $\lambda_g$ & $C_g$ & $cBGK$& $eBGK$\\
\hline
37.490 & 3.3446 & 0.0298 & 2.6302 & 4.0 & 15.362 \\
\hline
\end{tabular}
\end{center}
\end{table}
\\
For the BGK dipole model fits with valence quarks the initial parameters and the obtained $\chi^2$ are:
\begin{table}[ht]
\begin{center}
\begin{tabular}{|c||c||c||c|c||c|c|c||c|c|c||c|} 
\hline 
No& 
$Q^2$&&
$\sigma_0$ & $A_g$ & $\lambda_g$ & $C_g$ & $cBGK$& $eBGK$& $Np$& $\chi^2$& $\chi^2/Np$\\
\hline
1 &
$Q^2 \ge 3.5$ & NLO & 35.980 & 1.964 &-0.147& 3.068& 4.0 & 15.171 & 196& 245.74& 1.254 \\
\hline
2 &
$Q^2 \ge 8.5$ & NLO & 27.820& 3.660 &-0.076& 8.405& 4.0 & 18.188 & 157& 128.92&  0.821 \\
\hline
\end{tabular}
\end{center}
\end{table}
%%%%%%%%%%%
%\subsection{Unintegrated PDFs using CASCADE}
\subsection{TMD (unintegrated PDF) with CCFM}
\def\kt{\ensuremath{k_t}}
\newcommand{\Pmax}{p}
\newcommand{\CCFM}{CCFMa,CCFMb,Catani:1989sg,CCFMd}

In high energy factorization \cite{Catani:1990eg} the cross section is written as a convolution of the partonic cross section $\hat{\sigma}(É \kt)$ which depends on the transverse momentum $\kt$ of the incoming parton with the $\kt$-dependent parton density function ${\cal \tilde A}\left(x,\kt,\Pmax\right)$ (transverse momentum dependent (TMD) or unintegrated uPDF):
\begin{equation}
 \sigma  = \int 
\frac{dz}{z} d^2k_t \hat{\sigma}(\frac{x}{z},k_t)  {\cal \tilde A}\left(x,\kt,\Pmax\right)\label{kt-factorisation}
\end{equation}
The evolution of ${\cal \tilde A}\left(x,\kt,\Pmax\right)$ 
can proceed via the BFKL, DGLAP or via the CCFM evolution equations. Here, an extension of the CCFM \cite{\CCFM} evolution is applied. Since the evolution cannot be easily obtianed in  a closed form, 
 first a kernel $ {\cal \tilde A}\left(x'',\kt,\Pmax\right) $ is determined from the MC solution of the CCFM evolution equation, and then is folded with the non-perturbative starting distribution ${\cal A}_0 (x)$ \cite{Jung:2012hy}:
\begin{eqnarray}
x {\cal A}(x,\kt,\Pmax) &= &x\int dx' \int dx'' {\cal A}_0 (x) {\cal \tilde A}\left(x'',\kt,\Pmax\right)  \delta(x' \cdot x'' - x) \\
&= &\int dx' \int dx'' {\cal A}_0 (x) {\cal \tilde A}\left(x'',\kt,\Pmax\right) \frac{x}{x'} \delta(x'' - \frac{x}{x'}) \\
& = & \int dx' {{\cal A}_0 (x') }  
\cdot \frac{x}{x'}{ {\cal \tilde A}\left(\frac{x}{x'},\kt,\Pmax\right) } 
\end{eqnarray}
%An intrinsic $\kt$ dependence is included in the kernel ${\cal \tilde A}$
%\begin{eqnarray}
%{\cal \tilde A} & = & {\cal \tilde A'} \cdot f(k_{t\;0}) = {\cal \tilde A'} \cdot  \exp\left[ 
%-\frac{(\mu-k_{t\;0})^2}{\sigma^2}\right]
%\end{eqnarray}
The kernel  ${\cal \tilde A}$ includes all the dynamics of the evolution, Sudakov form factors and splitting functions and is determined in a grid of $50\otimes50\otimes50$ bins in $x,\kt,\Pmax$.  

The calculation of the cross section according to eq.(\ref{kt-factorisation}) involves a multidimensional Monte Carlo integration which is time consuming and suffers from numerical fluctuations, and cannot be used directly in a fit procedure involving the calculation of numerical derivates in the search for the minimum. Instead the following procedure is applied:
\begin{eqnarray}
\sigma_r(x,Q^2) & = & \int_x^1 d x_g {\cal A}(x_g,\kt,\Pmax) \hat{ \sigma}(x,x_g,Q^2) \\
  & = & \int_x^1 dx' {\cal A}_0 (x') \cdot \tilde{ \sigma}(x/x',Q^2) \label{final-convolution}
 \end{eqnarray}

The kernel ${\cal \tilde A}$ has to be provided separately and is not calculable within this program. The starting distribution  ${\cal A}_0$  at the starting scale $Q_0$ of the following form is used:
\begin{eqnarray}
x{\cal A}_0(x,\kt) &=& N x^{-B_g} \cdot (1 -x)^{C_g}\left( 1 -D_g x\right) 
\label{a0}
\end{eqnarray}
with free parameters $N,\, B_g,\, C_g,\, D_g$. 

In the present version, only the transverse momentum dependent gluon distribution can be obtained from the fit. 

The calculation of the $ep$ cross section follows eq.(\ref{kt-factorisation}), with the off-shell matrix element including quarks masses taken from \cite{Catani:1990eg} in its implementation in {\tt CASCADE} \cite{Jung:2010si} .In addition to the boson gluon fusion process, also valence quark initiated $\gamma q\to q$ processes are included, with the valence quarks taken from~\cite{Deak:2010gk}.

Please note that in the present version only DIS $ep$ processes can be used to determine the transverse momentum dependent (uPDF) gluon density distribution.

%%%%%%%%%%%
\subsection{Diffractive PDFs}
Diffractive DIS data are fitted within the 'proton vertex factorisation' approach where 
the diffractive DIS is mediated by the exchange of hard Pomeron and a secondary Reggeon.
The model supplied by the DiffDIS package provides values of the 'reduced cross section',
$\sigma_r = F_2 - y^2/(1+(1-y)^2) F_L$
which is expected to be the experimentally measured quantity.

\input{./dpdfs.tex}        

