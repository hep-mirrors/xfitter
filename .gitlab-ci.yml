variables:
  GIT_STRATEGY: fetch
  GIT_SUBMODULE_STRATEGY: recursive
  GIT_SSL_NO_VERIFY: "true"



stages:
- compile-minimal

.build_template: &build_template
  stage: compile-minimal
  image: $ARCH
  only:
    - merge_requests
    - schedules
  script:
    - ./make.sh install
  variables:
    CMAKE_FLAGS: "-DCMAKE_DISABLE_FIND_PACKAGE_ROOT=TRUE"

build_centos:
  variables:
    ARCH: centos
  <<: *build_template

build_ubuntu:
  variables:
    ARCH: ubuntu:20.04
  <<: *build_template

build_ubuntu_clang:
  variables:
    ARCH: clangbuiltlinux/ubuntu
  <<: *build_template

build_fedora:
  variables:
    ARCH: fedora:32
  <<: *build_template


